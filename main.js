(()=>{"use strict";var e,t,n,r,o={866:(e,t,n)=>{n.d(t,{$c:()=>_,EB:()=>l,O4:()=>m,Z_:()=>s,cp:()=>u,ed:()=>f,jc:()=>v,pC:()=>p,qF:()=>d,vI:()=>h,vV:()=>c});var r=n(365),o={baseUrl:"https://nomoreparties.co/v1/cohort-magistr-2",headers:{authorization:"810f9d35-1a2c-4cd0-b653-75ff9d8a0b16","Content-Type":"application/json"}},a=function(e){return e.ok?e.json():Promise.reject("Что-то пошло не так: ".concat(e.status))},c=function(e){console.log(e)},i=document.querySelector(".profile.page__section"),s={imageElement:i.querySelector(".profile__image"),titleElement:i.querySelector(".profile__title"),descriptionElement:i.querySelector(".profile__description"),_id:void 0,setProfileData:u};function u(e){s.imageElement.style.backgroundImage="url('".concat(e.avatar,"')"),s.titleElement.textContent=e.name,s.descriptionElement.textContent=e.about,s._id=e._id}var l=function(){return fetch("".concat(o.baseUrl,"/users/me"),{method:"GET",headers:o.headers}).then(a)},d=function(e,t){return fetch("".concat(o.baseUrl,"/users/me"),{method:"PATCH",headers:o.headers,body:JSON.stringify({name:e,about:t})}).then(a)};function p(e){return fetch("".concat(o.baseUrl,"/users/me/avatar"),{method:"PATCH",headers:o.headers,body:JSON.stringify({avatar:e})}).then(a)}function f(){return fetch("".concat(o.baseUrl,"/cards"),{method:"GET",headers:o.headers}).then(a).then((function(e){e.forEach((function(e){r.o.push(e)}))}))}function _(e,t){return fetch("".concat(o.baseUrl,"/cards"),{method:"POST",headers:o.headers,body:JSON.stringify({name:e,link:t})}).then(a)}function m(e){return fetch("".concat(o.baseUrl,"/cards/").concat(e),{method:"DELETE",headers:o.headers}).then(a)}function v(e){return fetch("".concat(o.baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:o.headers}).then(a)}function h(e){return fetch("".concat(o.baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:o.headers}).then(a)}},694:(e,t,n)=>{n.a(e,(async(e,r)=>{try{n.d(t,{Tm:()=>f,u4:()=>p});var o=n(497),a=n(866),c=e([o]);function i(e,t,n,r){var c=o.Tp.querySelector(".card").cloneNode(!0),i=c.querySelector(".card__like__count"),s=c.querySelector(".card__delete-button"),u=c.querySelector(".card__like-button");return c.querySelector(".card__image").src=e.link,c.querySelector(".card__image").alt="На фотке ".concat(e.name),c.querySelector(".card__title").textContent=e.name,i.textContent=e.likes.length,e.owner._id!==a.Z_._id&&s.remove(),l(u,e),c.addEventListener("click",(function(o){o.target.classList.contains("card__delete-button")&&t(o,e._id),o.target.classList.contains("card__like-button")&&n(o,e,i),o.target.classList.contains("card__image")&&r(o,e)})),c}function s(e,t){var n=e.target.closest(".card");(0,a.O4)(t).then((function(){n.remove()})).catch(a.vV)}function u(e,t,n){d(e,t).then((function(t){e.target.classList.toggle("card__like-button_is-active"),n.textContent=t.likes.length})).catch(a.vV)}function l(e,t){t.likes.some((function(e){return e._id===a.Z_._id}))&&e.classList.add("card__like-button_is-active")}function d(e,t){return e.target.classList.contains("card__like-button_is-active")?(0,a.vI)(t._id):(0,a.jc)(t._id)}function p(e){e.forEach((function(e){o.dm.append(i(e,s,u,o.ud))}))}function f(e){o.dm.prepend(i(e,s,u,o.ud))}o=(c.then?(await c)():c)[0],r()}catch(_){r(_)}}))},365:(e,t,n)=>{n.d(t,{o:()=>r});var r=[]},753:(e,t,n)=>{n.a(e,(async(e,r)=>{try{n.d(t,{Kl:()=>u,X6:()=>d,qo:()=>l});var o=n(947),a=n(694),c=n(497),i=n(866),s=e([a,c]);function u(e){e.preventDefault(),p(!0,e),(0,i.qF)(c.K3.value,c.i0.value).then((function(t){i.Z_.setProfileData(t),(0,o.Op)(e),e.target.reset()})).catch(i.vV).finally((function(){p(!1,e)}))}function l(e){e.preventDefault(),p(!0,e),(0,i.pC)(c.cR.value).then((function(t){(0,i.cp)(t),(0,o.Op)(e),e.target.reset()})).catch(i.vV).finally((function(){p(!1,e)}))}function d(e){e.preventDefault();var t=c.H9.value,n=c.Hs.value;(0,i.$c)(t,n).then((function(t){(0,a.Tm)(t),(0,o.Op)(e),e.target.reset()})).catch(i.vV).finally((function(){p(!1,e)}))}function p(e,t){t.target.querySelector(".popup__button").textContent=e?"Сохранение...":"Сохранить"}[a,c]=s.then?(await s)():s,r()}catch(f){r(f)}}))},947:(e,t,n)=>{function r(e){!function(e){e.classList.add("popup_is-opened")}(e),e.addEventListener("click",a),document.addEventListener("keydown",i)}function o(e){e.classList.remove("popup_is-opened"),document.removeEventListener("keydown",i),e.removeEventListener("click",a)}function a(e){(e.target.classList.contains("popup")||e.target.classList.contains("popup__close"))&&o(e.currentTarget)}function c(e){e.target.classList.contains("popup__form")&&o(document.querySelector(".popup_is-opened"))}function i(e){"Escape"===e.key&&o(document.querySelector(".popup_is-opened"))}n.d(t,{Op:()=>c,PB:()=>r})},547:(e,t,n)=>{n.d(t,{F:()=>a,R:()=>c});var r=function(e,t){e.disabled=!0,e.classList.add(t.inactiveButtonClass)},o=function(e,t,n){var r=e.querySelector(".".concat(t.id,"-error"));t.classList.remove(n.inputErrorClass),r.textContent="",r.classList.remove(n.errorClass)},a=function(e){Array.from(document.querySelectorAll(e.formSelector)).forEach((function(t){!function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),a=e.querySelector(t.submitButtonSelector);n.forEach((function(c){c.addEventListener("input",(function(){!function(e,t,n){t.validity.patternMismatch?t.setCustomValidity(t.dataset.errorMessage):t.setCustomValidity(""),t.validity.valid?o(e,t,n):function(e,t,n,r){var o=e.querySelector(".".concat(t.id,"-error"));t.classList.add(r.inputErrorClass),o.textContent=n,o.classList.add(r.errorClass)}(e,t,t.validationMessage,n)}(e,c,t),function(e,t,n){!function(e){return e.some((function(e){return!e.validity.valid}))}(e)?(t.disabled=!1,t.classList.remove(n.inactiveButtonClass)):r(t,n)}(n,a,t)}))}))}(t,e)}))},c=function(e,t){var n=Array.from(e.querySelectorAll(t.inputSelector)),a=e.querySelector(t.submitButtonSelector);n.forEach((function(n){n.setCustomValidity(""),o(e,n,t)})),r(a,t)}},497:(e,t,n)=>{n.a(e,(async(e,r)=>{try{n.d(t,{H9:()=>S,Hs:()=>g,K3:()=>m,Tp:()=>d,cR:()=>E,dm:()=>p,i0:()=>v,ud:()=>k});var o=n(947),a=n(753),c=n(547),i=n(866),s=n(365),u=n(694),l=e([a,u]);[a,u]=l.then?(await l)():l;var d=document.querySelector("#card-template").content,p=document.querySelector(".places__list");await Promise.all([(0,i.EB)(),(0,i.ed)()]).then((function(e){i.Z_.setProfileData(e[0]),(0,u.u4)(s.o)})).catch(i.vV);var f=document.querySelector(".content"),_=document.forms["edit-profile"],m=_.elements.name,v=_.elements.description,h=document.querySelector(".profile__title"),y=document.querySelector(".profile__description"),b=document.forms["new-place"],S=b.elements["place-name"],g=b.elements.link,q=document.forms["edit-avatar"],E=q.elements.link,L={formSelector:".popup__form",inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_disabled",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"};function k(e,t){var n=document.querySelector(".popup_type_image");(0,o.PB)(n),n.querySelector(".popup__image").src=t.link,n.querySelector(".popup__image").alt="На фотке ".concat(t.name),n.querySelector(".popup__caption").textContent=t.name}f.addEventListener("click",(function(e){if(e.target.classList.contains("profile__edit-button")){var t=document.querySelector(".popup_type_edit");m.value=h.textContent,v.value=y.textContent,(0,c.R)(_,L),(0,o.PB)(t)}else if(e.target.classList.contains("profile__add-button")){var n=document.querySelector(".popup_type_new-card");(0,c.R)(b,L),(0,o.PB)(n)}else if(e.target.classList.contains("profile__image")){var r=document.querySelector(".popup_type_avatar_edit");(0,c.R)(q,L),(0,o.PB)(r)}})),_.addEventListener("submit",a.Kl),b.addEventListener("submit",a.X6),q.addEventListener("submit",a.qo),(0,c.F)(L),r()}catch(C){r(C)}}),1)}},a={};function c(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={exports:{}};return o[e](n,n.exports,c),n.exports}e="function"==typeof Symbol?Symbol("webpack queues"):"__webpack_queues__",t="function"==typeof Symbol?Symbol("webpack exports"):"__webpack_exports__",n="function"==typeof Symbol?Symbol("webpack error"):"__webpack_error__",r=e=>{e&&e.d<1&&(e.d=1,e.forEach((e=>e.r--)),e.forEach((e=>e.r--?e.r++:e())))},c.a=(o,a,c)=>{var i;c&&((i=[]).d=-1);var s,u,l,d=new Set,p=o.exports,f=new Promise(((e,t)=>{l=t,u=e}));f[t]=p,f[e]=e=>(i&&e(i),d.forEach(e),f.catch((e=>{}))),o.exports=f,a((o=>{var a;s=(o=>o.map((o=>{if(null!==o&&"object"==typeof o){if(o[e])return o;if(o.then){var a=[];a.d=0,o.then((e=>{c[t]=e,r(a)}),(e=>{c[n]=e,r(a)}));var c={};return c[e]=e=>e(a),c}}var i={};return i[e]=e=>{},i[t]=o,i})))(o);var c=()=>s.map((e=>{if(e[n])throw e[n];return e[t]})),u=new Promise((t=>{(a=()=>t(c)).r=0;var n=e=>e!==i&&!d.has(e)&&(d.add(e),e&&!e.d&&(a.r++,e.push(a)));s.map((t=>t[e](n)))}));return a.r?u:c()}),(e=>(e?l(f[n]=e):u(p),r(i)))),i&&i.d<0&&(i.d=0)},c.d=(e,t)=>{for(var n in t)c.o(t,n)&&!c.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c(497)})();